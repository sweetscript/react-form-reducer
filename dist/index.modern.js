import e,{useState as t,useReducer as r,useEffect as n,createContext as s,useContext as a}from"react";function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}function i(){const[e,r]=t({});return l(e,r)}function l(e,t){const r={errors:e,has:t=>e&&!!Object.getOwnPropertyDescriptor(e,t),hasAny:t=>!!e&&t.filter(t=>!!Object.getOwnPropertyDescriptor(e,t)).length>0,hasErrors:()=>Object.keys(e).length>0},n=t||function(e){r.errors=e};return r.get=t=>r.has(t)?e[t]:[],r.first=t=>{var n;return r.has(t)?null==e||null==(n=e[t])?void 0:n[0]:null},r.all=()=>e,r.add=(t,s)=>{const a=o({},e);r.has(t)||(a[t]=[]),-1===a[t].indexOf(s)&&a[t].push(s),n(a)},r.set=e=>{n(e)},r.forget=t=>{if(t){if(e[t]){const r=o({},e);delete r[t],n(r)}}else r.hasErrors()&&n({})},r}function u(e,s,a){const u=i(),[c,d]=t(!1),[f,p]=t(!1),[h,v]=t(1),[g,b]=t({passed:!1}),{onUpdateFields:y}=s||{},[O,m]=r((e,t)=>o({},e,t),e),[x,j]=r((e,t)=>o({},e,t),a),I=(e,t=!0)=>{y&&(e=y(e)),m(e),d(t)},w=(e,t)=>{const r={};r[e]=t,I(r,!0),u.forget(e)},E=e=>t=>{const r=t.currentTarget||t.target,n=r.getAttribute("type")||"text";-1!==["checkbox","radio"].indexOf(n)?w(e,r instanceof HTMLInputElement&&r.checked):-1!==["number","range"].indexOf(n)?w(e,Number(r.value)):w(e,r.value)},F=e=>t=>{w(e,t)},M=e=>{j(e)},D=(e,t=!0)=>{const r=null==s?void 0:s.validation;if(!r)throw new Error("No validator resolver passed");const n=r.validate(O,e);return 1==n?{passed:!0}:(t&&u.set(n),{passed:!1,errorMessages:n,errors:l(n)})};return n(()=>{null!=s&&s.validation&&b(D(void 0,!1))},[O]),{fields:O,setFields:I,setField:w,handleInputChange:E,assignFieldInput:e=>({onChange:E(e),value:null==O?void 0:O[e],disabled:f}),assignFieldUI:e=>({value:null==O?void 0:O[e],disabled:f,onChange:F(e),error:u.has(e),helperText:u.first(e)||void 0}),reset:()=>{I(e,!1)},errors:u,isDirty:c,setIsDirty:d,isBusy:f,setIsBusy:p,step:h,setStep:v,validate:D,validationWatcher:g,meta:x,setAllMeta:M,setMeta:(e,t)=>{const r={};r[e]=t,M(r)}}}const c=/*#__PURE__*/s({});function d(){return c}function f({children:t,defaultValues:r,options:n,defaultMeta:s}){const a=u(r,n,s),o=d();/*#__PURE__*/return e.createElement(o.Provider,{value:a},t)}function p(){return a(d())}class h{}export{d as FormContext,f as FormContextProvider,h as ValidationResolver,u as useForm,p as useFormContext,i as useFormErrors};
